<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
  </style>
</head>

<body>
  <div>
  	<input id="slider" type="range" value="0" min="0" max="464" step="1" onchange="update(this.value);" oninput="update(this.value);" />
	</div>
  
  <script>
    
    var slider = document.getElementById("slider");   
    
    var svg = d3.select("body").append("svg")
      .attr("width", 1000)
      .attr("height", 500)
    
    var g = svg.append("g")
    
    //affichage des cercles de la légende
      	g.append("circle")
    			.attr("r", 10)
      		.attr("cx", 750)
      		.attr("cy", 200)
      		.style("fill","#99ccff")
				g.append("circle")
    			.attr("r", 10)
      		.attr("cx", 750)
      		.attr("cy", 250)
      		.style("fill","#99ccff")
      		.style("stroke","#0099ff")
      		.attr('fill-opacity', 0)
        
    //Titre
        g.append("text")
        	.attr("id", "title")
      		.text("North and South ice extent by month")    	
      		.attr("x", 245)
      		.attr("y", 450)
      		.style("font-size", "30px")
    
		//Year,Month,mean_extent
    
    update(0)
    
    function update(val){
      svg.select("#north_extent").remove()
      svg.select("#north_extent_ref").remove()
      svg.select("#south_extent").remove()
      svg.select("#south_extent_ref").remove()  
      svg.select("#legend").remove()   
      svg.select("#legend_ref").remove()   
      svg.select("#legend_slider").remove()   
      
    	d3.csv("data/north_mean_extent.csv", function(data) {
        
        var chosen_date = data[val].Month+"/"+data[val].Year
      	  
    
    		g.append("circle")
        	.attr("id", "north_extent")
        	.attr("r", data[val].mean_extent*5)
    			.attr("cx", 460)
    			.attr("cy", 100)
        	.style("fill","#99ccff")
        
        g.append("circle")        	
        	.attr("id", "north_extent_ref")
        	.attr("r", data[val%12].mean_extent*5)
    			.attr("cx", 460)
    			.attr("cy", 100)
      		.style("fill","#99ccff")
        	.style("stroke","#0099ff")
        	.attr('fill-opacity', 0)
        
        //affichage de la légende
      	g.append("text")
        	.attr("id", "legend")
      		.text("Ice Extent in "+chosen_date)    	
      		.attr("x", 775)
      		.attr("y", 204)
      		.style("font-size", 10)  
   
    		g.append("text")
        	.attr("id", "legend_ref")
      		.text("Ice Extent in "+data[val%12].Month+"/"+data[val%12].Year)    	
      		.attr("x", 775)
      		.attr("y", 254)
      		.style("font-size", 10)
        
        g.append("text")
        	.attr("id", "legend_slider")
      		.text(chosen_date)    	
      		.attr("x", 50)
      		.attr("y", 13)
      		.style("font-size", 10)
        
        chosen_date
        
    	})
      
      d3.csv("data/south_mean_extent.csv", function(data) {
    
    		g.append("circle")
        	.attr("id", "south_extent")
        	.attr("r", data[val].mean_extent*5)
    			.attr("cx", 460)
    			.attr("cy", 300)
      		.style("fill","#99ccff")
        
        g.append("circle")
        	.attr("id", "south_extent_ref")
        	.attr("r", data[val%12].mean_extent*5)
    			.attr("cx", 460)
    			.attr("cy", 300)      		
        	.attr('fill-opacity', 0)
        	.style("stroke","#0099ff")
    	})
      
      
      
      
    }      
  </script>
</body>
