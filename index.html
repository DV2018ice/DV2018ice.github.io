<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
	<title>DataViz groupe 0</title>


	<!-- Font style -->
	<link href="https://fonts.googleapis.com/css?family=Muli:600" rel="stylesheet"> 

	<!-- BOOTSTRAP INCLUDES CSS  -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
	<!-- MY CSS -->
	<link rel="stylesheet" type="text/css" href="./css/css.css">

	<!-- D3 JS V4 -->
	<script src="https://d3js.org/d3.v4.min.js"></script> <!-- Load d3.js -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js"></script>
	<!-- MY JS -->
	<script type="text/javascript"  src="./js/d3-scale-radial.js"></script> <!-- Function for radial charts -->
	<script type="text/javascript"  src="./js/functionUtils.js"></script> <!-- Function for radial charts -->



</head>

<body>
	<!-- navbar-expand-lg -->
	<nav class="navbar sticky-top navbar-expand navbar-light" style="background-color: rgb(182,182,182);">
		<!-- <a class="navbar-brand" href="#">Bar de navigation</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button> -->

		<div class="collapse navbar-collapse" id="navbarText">
			<ul class="navbar-nav mr-auto">
				<!-- <li class="nav-item active">
					<a class="nav-link" href="#">Présentation du projet<span class="sr-only">(current)</span></a>
				</li> -->
				<li class="nav-item">
					<a class="nav-link"  href="#section1">Présentation du projet</a>
				</li>
				<li class="nav-item">
					<a class="nav-link"  href="#section2">Visualisation</a>
				</li>
				<li class="nav-item">
					<a class="nav-link"  href="#section3">Déduction</a>
				</li>
			</ul>
		</div>
	</nav>

	<div id="section1" class="container-fluid">
		<h1>Présentation du projet de data visualisation du groupe 0</h1>
		<p>
			Le réchauffement climatique est un sujet bien connu, de nos jours.
			<br>
			On s'interroge à la fois sur ses causes que sur ses conséquences.
			<br>
			La fonte des glaces polaires est souvent citée comme étant l'une de ces conséquences.
			<br>
			Est-ce vraiment le cas ? Quelle est l'importance de ce phénomène ? Nous allons tenter de répondre à ces questions à l'aide d'une visualisation de données.
		</p>

	</div>





	<div class="container-fluid" id="section2">

		<!-- <div class="row" id="title" align="center">
			<h1 align="center">Etendue annuelle des calottes glaciaires, de 1979 à 2016</h1>
		</div> -->

		<div class="row">
			<div class="col col-lg" align="center">
				<h1 align="center">Etendue annuelle des calottes glaciaires, de 1979 à 2016</h1>
			</div>
		</div>

		<br>
		<div class="row">
			<div class="col col-lg" align="center">
				<h2 align="center">Pôle Nord</h2>
			</div>
		</div>


		<div class="row" id="escargots">

			<!-- PADDING -->
			<div class="col-1"></div>


			<!-- COLONNE NORD -->
			<div class="col-4" id="my_dataviz"></div>


			<!-- PADDING -->
			<div class="col-2"></div>


			<!-- COLONNE SUD -->
			<div class="col-4" id="my_dataviz_line_temp">
			</div>


			<!-- PADDING -->
			<div class="col-1"></div>
		</div>




		<div class="row" id="graphiques">

			<!-- PADDING -->
			<div class="col-1"></div>

			<!-- COLONNE NORD -->
			<div class="col-4" id="my_dataviz_south">
			</div>

			<!-- PADDING -->
			<div class="col-2">
				<h2>Pôle Sud</h2>
			</div>


			<!-- COLONNE SUD -->
			<div class="col-4" id="my_dataviz_line_extent">
			</div>

			<!-- PADDING -->
			<div class="col-1"></div>
		</div>
	</div>





	<div id="section3" class="container-fluid">
		<h1>Conclusion</h1>


		<p>Nous pouvons conclure, d'après cette visualisation, que la température aux pôles n'a presque pas changé. Cependant, la surface de glace au pôle Nord diminue effectivement alors que celle du pôle Sud semble augmenter. La fonte des glaces ne semble donc s'appliquer qu'au pôle Nord et elle ne semble pas due à une augmentation de la température.</p>
	</div>


	<script>


		init();

		var heightDivLineChart = 200;
		var widthDivLineChart = 500;
		var heightLineChart = 100;
		var widthLineChart = 400;

		var widthDiv = document.getElementById("my_dataviz").clientWidth;

		cs(document.getElementById("my_dataviz").clientWidth)
		cs(document.getElementById("my_dataviz_south").clientWidth)
		// set the dimensions and margins of the graph
		var margin = {top: 10, right: 200, bottom: 10, left: 10},
		width = widthDiv,
		height = 460 - margin.top - margin.bottom,
		innerRadius = 80,
		outerRadius = Math.min(width, height) / 2;   // the outerRadius goes from the middle of the SVG area to the border

		// Y scale
		var y = d3.scaleRadial()
		.range([innerRadius, outerRadius])   // Domain will be define later.
		.domain([6, 13]); // Domain of Y is from 0 to the max seen in the data

		var snailBase = "#00000";
		var snailTransi = "#11111";

		// append the svg object to the body of the page
		var svg = d3.select("#my_dataviz")
		.append("svg")
		//.attr("width", 600)
		.attr("width", width)
		.attr("height", height + margin.top + margin.bottom)
		.attr("id", "svg_north")
		.append("g")
		.attr("transform", "translate(" + width / 2 + "," + ( height/2 )+ ")"); // Add 100 on Y translation, cause 

		// append the svg object to the body of the page
		var svg_south = d3.select("#my_dataviz_south")
		.append("svg")
		//.attr("width", width + margin.left + margin.right)
		.attr("width", width)
		//.attr("width", 600)
		.attr("height", height + margin.top + margin.bottom)
		.attr("id", "svg_south")
		.append("g")
		.attr("transform", "translate(" + width / 2 + "," + ( height/2 )+ ")"); // Add 100 on Y translation, cause upper bars are longers

		// Div de tooltip pour le cercle
		var tooltip = d3.select("body").append("div")
		.attr("class", "tooltip")
		.style("opacity", 0);

		var colorScale=d3.scaleLinear()
		.domain([10,13])
		.range(["white",  "#3399FF"]);

		var g = svg.append("g");

		var dataSudYear = []
		var dataNordYear = []
		var dataNordYearT = []


		d3.csv("./data/north_mean_extent_year.csv", function(data) {

			// X scale
			var x = d3.scaleBand()
			.range([0, 2 * Math.PI])    // X axis goes from 0 to 2pi = allaround the circle. If I stop at 1Pi, it will be around a half circle
			.align(0)                  // This does nothing ?
			.domain( data.map(function(d) { return d.Year; }) ); // The domain of the X axis is the list of states.

			// Add bars
			svg.append("g")
			.selectAll("path")
			.data(data)
			.enter()
			.append("path")
			.attr("fill", function (i) { return colorScale (i.mean_extent);})
			//.attr("text", "ok")
			.attr("d", d3.arc()     // imagine your doing a part of a donut plot
				.innerRadius(innerRadius)
				.outerRadius(function(d) { return y(d['mean_extent']); })
				.startAngle(function(d) { return x(d.Year); })
				.endAngle(function(d) { return x(d.Year) + x.bandwidth(); })
				.padAngle(0.1)
				.padRadius(innerRadius)
				)
			.on("mouseover", function(d){
				displayTooltip(this);
				//divAnnee(d.Year, (d3.event.pageX), (d3.event.pageY - 28));
				//getTemp(d.Year, "north");
				displayLineChart()
				displayFrance(d)
				displayFrance_South(d)
				// document.getElementById("title_extent").style.display='block';
				d3.selectAll("#my_dataviz_line_temp > #svgTemp").remove(); 
				d3.selectAll("#my_dataviz_line_extent > #svg").remove(); 
			})
			.on("mouseout", function(d){
				hideTooltip(this);
				

				//var x = document.getElementById("title_extent");
				//document.getElementById("title_extent").style.display='none';
				//hide(x)
				//document.getElementsByTagName('h1')[0].style.display = 'none';
			});

			var text = svg.selectAll("text")
			.data(data)
			.enter()
			.append("text");

			var textLabels = text
			.attr("x", function(d){ 
				if(d.Year=="1979" || d.Year=="1997") 
					return 0; 
				else if(d.Year=="2016")
					return -45;
				else
					return 150
			})
			.attr("y", function(d){ 
				if(d.Year=="1979") 
					return -200; 
				else if(d.Year=="1997") 
					return 200; 
				else if(d.Year=="2016")
					return -190
				
			})
			.text( function (d) { if(d.Year=="1979" || d.Year=="1997" || d.Year=="2016") return d.Year; })
			.attr("font-family", "sans-serif")
			.attr("font-size", "20px")
			.attr("fill", "white");
			
			/*var textLabels2016 = text
			.attr("x", function(d){ 
				if(d.Year=="2016") 
					return -100; 
				else 
					return 150;  })
			.attr("y", function(d){ 
				if(d.Year=="2016") 
					return -200; 
				else 
					return 200; 
			})
			.text( function (d) { if(d.year=="2016") return d.Year; })
			.attr("font-family", "sans-serif")
			.attr("font-size", "20px")
			.attr("fill", "white");*/
			
		});



		d3.csv("./data/south_mean_extent_year.csv", function(data) {

			// X scale
			var x = d3.scaleBand()
			.range([0, 2 * Math.PI])    // X axis goes from 0 to 2pi = allaround the circle. If I stop at 1Pi, it will be around a half circle
			.align(0)                  // This does nothing ?
			.domain( data.map(function(d) { return d.Year; }) ); // The domain of the X axis is the list of states.

			// Y scale
			/*var y = d3.scaleRadial()
			.range([innerRadius, outerRadius])   // Domain will be define later.
			.domain([10, 13]); // Domain of Y is from 0 to the max seen in the data*/

			svg_south.append("g")
			.selectAll("path")
			.data(data)
			.enter()
			.append("path")
			.attr("fill", function (i) { return colorScale (i.mean_extent);})
				//.attr("text", "ok")
			.attr("d", d3.arc()     // imagine your doing a part of a donut plot
				.innerRadius(innerRadius)
				.outerRadius(function(d) { return y(d['mean_extent']); })
				.startAngle(function(d) { return x(d.Year); })
				.endAngle(function(d) { return x(d.Year) + x.bandwidth(); })
				.padAngle(0.1)

				.padRadius(innerRadius)
				)

			// Au passage de la souris
			.on("mouseover", function(d){
				displayTooltip(this);

				//divAnneeTest(d.Year);
				// divAnnee(d.Year, (d3.event.pageX), (d3.event.pageY - 28));
				// getTemp(d.Year, "south");
				displayLineChart()
				// Ajout des map de france
				displayFrance(d)
				displayFrance_South(d)
				d3.selectAll("#my_dataviz_line_temp > #svgTemp").remove(); 
				d3.selectAll("#my_dataviz_line_extent > #svg").remove(); 
			})

			// Lorsque l'on retire la souris
			.on("mouseout", function(d){
				hideTooltip(this);
				
			});
			var text2 = svg_south.selectAll("text2")
			.data(data)
			.enter()
			.append("text");

			var textLabels2 = text2
			.attr("x", function(d){ 
				if(d.Year=="1979" || d.Year=="1997") 
					return 0; 
				else if(d.Year=="2016")
					return -45;
				else 
					return 150;  })
			.attr("y", function(d){ 
				if(d.Year=="1979") 
					return -200; 
				else if(d.Year=="1997")
					return 200; 
				else if(d.Year=="2016")
					return -190
			})
			.text( function (d) { if(d.Year=="1979" || d.Year=="1997" || d.Year=="2016") return d.Year; })
			.attr("font-family", "sans-serif")
			.attr("font-size", "20px")
			.attr("fill", "white");
			
			

		});


		
	</script>
	
	<footer>
	Elise Guiraud, Clément Cascales, Nicolas Loiseau--Viton et Julien Thomas <br>
	<a href="url">https://www.d3-graph-gallery.com/graph/circular_barplot_basic.html</a><br>
	<a href="url">https://docs.google.com/document/d/1y9GVjgDm92eZbXWagMJ42XGKJC_3DHIKRjNLFezMbRQ/edit#heading=h.h609stdapcov</a><br>
	<a href="url">https://www.kaggle.com/nsidcorg/daily-sea-ice-extent-data</a><br>
	<a href="url">http://sdwebx.worldbank.org/climateportal/index.cfm?page=country_historical_climate&ThisCCode=GRL</a><br>
	<a href="url">http://www.nerc-bas.ac.uk/icd/gjma/vostok.temps.html</a><br>
	</footer> 
</body>
</html>